webpackJsonp([135],{2156:function(n,e,l){"use strict";function t(n){return E._42(0,[(n()(),E._16(0,0,null,null,1,"ion-icon",[["name","funnel"],["role","img"]],[[2,"hide",null]],null,null,null,null)),E._15(1,147456,null,0,ln.a,[tn.a,E.p,E.K],{name:[0,"name"]},null)],function(n,e){n(e,1,0,"funnel")},function(n,e){n(e,0,0,E._29(e,1)._hidden)})}function i(n){return E._42(0,[(n()(),E._16(0,0,null,null,1,"ion-icon",[["name","ios-funnel-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),E._15(1,147456,null,0,ln.a,[tn.a,E.p,E.K],{name:[0,"name"]},null)],function(n,e){n(e,1,0,"ios-funnel-outline")},function(n,e){n(e,0,0,E._29(e,1)._hidden)})}function a(n){return E._42(0,[(n()(),E._16(0,0,null,null,8,"ion-card",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),E._15(1,16384,null,0,an.a,[tn.a,E.p,E.K],null,null),(n()(),E._40(-1,null,["\n                "])),(n()(),E._16(3,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),E._15(4,147456,null,0,ln.a,[tn.a,E.p,E.K],{name:[0,"name"]},null),(n()(),E._40(5,null,[" ","\n            "])),E._32(131072,un.a,[rn.a,E.i]),E._33(7,{$a:0}),E._32(131072,un.a,[rn.a,E.i])],function(n,e){n(e,4,0,"warning")},function(n,e){n(e,3,0,E._29(e,4)._hidden);n(e,5,0,E._41(e,5,0,E._29(e,8).transform("core.hasdatatosync",n(e,7,0,E._41(e,5,0,E._29(e,6).transform("addon.calendar.calendar"))))))})}function u(n){return E._42(0,[(n()(),E._16(0,0,null,null,3,"core-empty-box",[["icon","calendar"]],null,null,null,on.b,on.a)),E._15(1,49152,null,0,sn.a,[],{message:[0,"message"],icon:[1,"icon"]},null),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,0,["\n            "]))],function(n,e){n(e,1,0,E._41(e,1,0,E._29(e,2).transform("addon.calendar.noevents")),"calendar")},null)}function r(n){return E._42(0,[(n()(),E._16(0,0,null,null,7,"ion-item-divider",[["class","item item-divider"]],null,null,null,cn.b,cn.a)),E._15(1,1097728,null,3,dn.a,[fn.a,tn.a,E.p,E.K,[2,_n.a]],null,null),E._37(335544320,4,{contentLabel:0}),E._37(603979776,5,{_buttons:1}),E._37(603979776,6,{_icons:1}),E._15(5,16384,null,0,hn.a,[tn.a,E.p,E.K],null,null),(n()(),E._40(6,2,["\n                        ","\n                    "])),E._34(7,2)],null,function(n,e){n(e,6,0,E._41(e,6,0,n(e,7,0,E._29(e.parent.parent.parent,0),1e3*e.parent.context.$implicit.timestart,"strftimedayshort")))})}function o(n){return E._42(0,[(n()(),E._16(0,0,null,null,0,"img",[["class","core-module-icon"],["item-start",""]],[[8,"src",4]],null,null,null,null))],null,function(n,e){n(e,0,0,E._19(1,"",e.parent.context.$implicit.moduleIcon,""))})}function s(n){return E._42(0,[(n()(),E._16(0,0,null,null,1,"core-icon",[["item-start",""]],null,null,null,vn.b,vn.a)),E._15(1,704512,null,0,pn.a,[E.p,tn.a],{name:[0,"name"]},null)],function(n,e){n(e,1,0,e.parent.context.$implicit.eventIcon)},null)}function c(n){return E._42(0,[(n()(),E._16(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),E._40(1,null,[" - ",""])),E._34(2,2)],null,function(n,e){n(e,1,0,E._41(e,1,0,n(e,2,0,E._29(e.parent.parent.parent,0),1e3*(e.parent.context.$implicit.timestart+e.parent.context.$implicit.timeduration),"strftimetime")))})}function d(n){return E._42(0,[(n()(),E._16(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),E._40(1,null,[" - ",""])),E._34(2,2)],null,function(n,e){n(e,1,0,E._41(e,1,0,n(e,2,0,E._29(e.parent.parent.parent,0),1e3*(e.parent.context.$implicit.timestart+e.parent.context.$implicit.timeduration),"strftimedatetimeshort")))})}function f(n){return E._42(0,[(n()(),E._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),E._15(1,16384,null,0,mn.a,[tn.a,E.p,E.K],null,null),(n()(),E._40(-1,null,["\n                            "])),(n()(),E._16(3,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),E._15(4,147456,null,0,ln.a,[tn.a,E.p,E.K],{name:[0,"name"]},null),(n()(),E._40(-1,null,["\n                            "])),(n()(),E._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),E._40(7,null,["",""])),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,null,["\n                        "]))],function(n,e){n(e,4,0,"time")},function(n,e){n(e,3,0,E._29(e,4)._hidden);n(e,7,0,E._41(e,7,0,E._29(e,8).transform("core.notsent")))})}function _(n){return E._42(0,[(n()(),E._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),E._15(1,16384,null,0,mn.a,[tn.a,E.p,E.K],null,null),(n()(),E._40(-1,null,["\n                            "])),(n()(),E._16(3,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),E._15(4,147456,null,0,ln.a,[tn.a,E.p,E.K],{name:[0,"name"]},null),(n()(),E._40(-1,null,["\n                            "])),(n()(),E._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),E._40(7,null,["",""])),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,null,["\n                        "]))],function(n,e){n(e,4,0,"trash")},function(n,e){n(e,3,0,E._29(e,4)._hidden);n(e,7,0,E._41(e,7,0,E._29(e,8).transform("core.deletedoffline")))})}function h(n){return E._42(0,[(n()(),E._16(0,0,null,null,40,null,null,null,null,null,null,null)),(n()(),E._40(-1,null,["\n                    "])),(n()(),E._11(16777216,null,null,1,null,r)),E._15(3,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,null,["\n                    "])),(n()(),E._16(5,0,null,null,34,"a",[["class","addon-calendar-event item item-block"],["ion-item",""],["text-wrap",""]],[[8,"title",0],[2,"core-split-item-selected",null]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.gotoEvent(n.context.$implicit.id)&&t}return t},cn.b,cn.a)),E._15(6,278528,null,0,En.i,[E.v,E.w,E.p,E.L],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),E._31(7,1),E._15(8,1097728,null,3,dn.a,[fn.a,tn.a,E.p,E.K,[2,_n.a]],null,null),E._37(335544320,7,{contentLabel:0}),E._37(603979776,8,{_buttons:1}),E._37(603979776,9,{_icons:1}),E._15(12,16384,null,0,gn.a,[],null,null),(n()(),E._40(-1,2,["\n                        "])),(n()(),E._11(16777216,null,0,1,null,o)),E._15(15,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,2,["\n                        "])),(n()(),E._11(16777216,null,0,1,null,s)),E._15(18,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,2,["\n                        "])),(n()(),E._16(20,0,null,2,2,"h2",[],null,null,null,null,null)),(n()(),E._16(21,16777216,null,null,1,"core-format-text",[],null,null,null,null,null)),E._15(22,540672,null,0,bn.a,[E.p,N.a,w.a,In.a,rn.a,yn.a,A.a,On.a,Cn.a,Dn.a,$.a,Tn.a,[2,xn.a],[2,Ln.a],[2,K.a],wn.a,P.a,Sn.a,An.a,Nn.a,E.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"]},null),(n()(),E._40(-1,2,["\n                        "])),(n()(),E._16(24,0,null,2,8,"p",[],null,null,null,null,null)),(n()(),E._40(25,null,["\n                            ","\n                            "])),E._34(26,2),(n()(),E._11(16777216,null,null,1,null,c)),E._15(28,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,null,["\n                            "])),(n()(),E._11(16777216,null,null,1,null,d)),E._15(31,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,null,["\n                        "])),(n()(),E._40(-1,2,["\n                        "])),(n()(),E._11(16777216,null,4,1,null,f)),E._15(35,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,2,["\n                        "])),(n()(),E._11(16777216,null,4,1,null,_)),E._15(38,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,2,["\n                    "])),(n()(),E._40(-1,null,["\n                "]))],function(n,e){n(e,3,0,e.context.$implicit.showDate);n(e,6,0,"addon-calendar-event",n(e,7,0,"addon-calendar-eventtype-"+e.context.$implicit.eventtype));n(e,15,0,e.context.$implicit.moduleIcon);n(e,18,0,e.context.$implicit.eventIcon&&!e.context.$implicit.moduleIcon);n(e,22,0,e.context.$implicit.name,e.context.$implicit.contextLevel,e.context.$implicit.contextInstanceId);n(e,28,0,e.context.$implicit.timeduration&&e.context.$implicit.endsSameDay);n(e,31,0,e.context.$implicit.timeduration&&!e.context.$implicit.endsSameDay);n(e,35,0,e.context.$implicit.offline&&!e.context.$implicit.deleted);n(e,38,0,e.context.$implicit.deleted)},function(n,e){n(e,5,0,e.context.$implicit.name,e.context.$implicit.id==e.component.eventId);n(e,25,0,E._41(e,25,0,n(e,26,0,E._29(e.parent.parent,0),1e3*e.context.$implicit.timestart,"strftimetime")))})}function v(n){return E._42(0,[(n()(),E._16(0,0,null,null,5,"ion-list",[["no-margin",""]],null,null,null,null,null)),E._15(1,16384,null,0,kn.a,[tn.a,E.p,E.K,yn.a,Pn.l,$n.a],null,null),(n()(),E._40(-1,null,["\n                "])),(n()(),E._11(16777216,null,null,1,null,h)),E._15(4,802816,null,0,En.j,[E.W,E.T,E.v],{ngForOf:[0,"ngForOf"]},null),(n()(),E._40(-1,null,["\n            "]))],function(n,e){n(e,4,0,e.component.filteredEvents)},null)}function p(n){return E._42(0,[(n()(),E._16(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,Kn.b,Kn.a)),E._15(1,212992,null,0,Rn.a,[E.p,Ln.a],null,null),E._15(2,1228800,null,2,Wn.a,[yn.a],null,null),E._37(335544320,10,{_mainButton:0}),E._37(603979776,11,{_fabLists:1}),(n()(),E._40(-1,0,["\n            "])),(n()(),E._16(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.openEdit()&&t}return t},Mn.b,Mn.a)),E._15(7,49152,[[10,4]],0,Vn.a,[tn.a,E.p,E.K],null,null),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,0,["\n                "])),(n()(),E._16(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),E._15(11,147456,null,0,ln.a,[tn.a,E.p,E.K],{name:[0,"name"]},null),(n()(),E._40(-1,0,["\n            "])),(n()(),E._40(-1,0,["\n        "]))],function(n,e){n(e,1,0);n(e,11,0,"add")},function(n,e){n(e,6,0,E._41(e,6,0,E._29(e,8).transform("addon.calendar.newevent")));n(e,10,0,E._29(e,11)._hidden)})}function m(n){return E._42(0,[E._32(0,Un.a,[Cn.a,S.a]),E._37(402653184,1,{content:0}),E._37(402653184,2,{splitviewCtrl:0}),(n()(),E._16(3,0,null,null,40,"ion-header",[],null,null,null,null,null)),E._15(4,16384,null,0,Hn.a,[tn.a,E.p,E.K,[2,Fn.a]],null,null),(n()(),E._40(-1,null,["\n    "])),(n()(),E._16(6,0,null,null,36,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Yn.b,Yn.a)),E._15(7,49152,null,0,jn.a,[zn.a,[2,Fn.a],[2,xn.a],tn.a,E.p,E.K],null,null),E._15(8,212992,null,0,Bn.a,[jn.a,yn.a,rn.a,P.a],null,null),(n()(),E._40(-1,3,["\n        "])),(n()(),E._16(10,0,null,3,3,"ion-title",[],null,null,null,Gn.b,Gn.a)),E._15(11,49152,null,0,Jn.a,[tn.a,E.p,E.K,[2,qn.a],[2,jn.a]],null,null),(n()(),E._40(12,0,["",""])),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,3,["\n        "])),(n()(),E._16(15,0,null,2,26,"ion-buttons",[["end",""]],null,null,null,null,null)),E._15(16,16384,null,1,Qn.a,[tn.a,E.p,E.K,[2,qn.a],[2,jn.a]],null,null),E._37(603979776,3,{_buttons:1}),(n()(),E._40(-1,null,["\n            "])),(n()(),E._16(19,0,null,null,9,"button",[["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.openFilter(l)&&t}return t},Xn.b,Xn.a)),E._15(20,1097728,[[3,4]],0,Zn.a,[[8,""],tn.a,E.p,E.K],null,null),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,0,["\n                "])),(n()(),E._11(16777216,null,0,1,null,t)),E._15(24,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,0,["\n                "])),(n()(),E._11(16777216,null,0,1,null,i)),E._15(27,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,0,["\n            "])),(n()(),E._40(-1,null,["\n            "])),(n()(),E._16(30,0,null,null,10,"core-context-menu",[],null,null,null,ne.b,ne.a)),E._15(31,245760,null,0,ee.a,[rn.a,le.a,E.p,w.a,[2,te.a],A.a],null,null),(n()(),E._40(-1,0,["\n                "])),(n()(),E._16(33,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.openSettings()&&t}return t},ie.b,ie.a)),E._15(34,770048,null,0,ae.a,[ee.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,0,["\n                "])),(n()(),E._16(37,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.doRefresh(null,l,!0)&&t}return t},ie.b,ie.a)),E._15(38,770048,null,0,ae.a,[ee.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,0,["\n            "])),(n()(),E._40(-1,null,["\n        "])),(n()(),E._40(-1,3,["\n    "])),(n()(),E._40(-1,null,["\n"])),(n()(),E._40(-1,null,["\n"])),(n()(),E._16(45,0,null,null,35,"core-split-view",[],null,null,null,ue.b,ue.a)),E._15(46,245760,[[2,4]],0,K.a,[[2,xn.a],E.p,re.a,yn.a,rn.a],null,null),(n()(),E._40(-1,0,["\n    "])),(n()(),E._16(48,0,null,0,31,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,oe.b,oe.a)),E._15(49,4374528,[[1,4]],0,Ln.a,[tn.a,yn.a,$n.a,E.p,E.K,zn.a,se.a,E.D,[2,Fn.a],[2,xn.a]],null,null),(n()(),E._40(-1,1,["\n        "])),(n()(),E._16(51,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,e,l){var t=!0;if("ionRefresh"===e){t=!1!==n.component.doRefresh(l)&&t}return t},null,null)),E._15(52,212992,null,0,ce.a,[yn.a,Ln.a,E.D,Pn.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),E._40(-1,null,["\n            "])),(n()(),E._16(54,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,de.b,de.a)),E._15(55,114688,null,0,fe.a,[ce.a,tn.a],{pullingText:[0,"pullingText"]},null),E._32(131072,un.a,[rn.a,E.i]),(n()(),E._40(-1,null,["\n        "])),(n()(),E._40(-1,1,["\n        "])),(n()(),E._16(59,0,null,1,15,"core-loading",[],null,null,null,_e.b,_e.a)),E._15(60,638976,null,0,he.a,[rn.a,E.p,P.a,A.a],{hideUntil:[0,"hideUntil"]},null),(n()(),E._40(-1,0,["\n            "])),(n()(),E._40(-1,0,["\n            "])),(n()(),E._11(16777216,null,0,1,null,a)),E._15(64,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,0,["\n\n            "])),(n()(),E._11(16777216,null,0,1,null,u)),E._15(67,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,0,["\n\n            "])),(n()(),E._11(16777216,null,0,1,null,v)),E._15(70,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,0,["\n\n            "])),(n()(),E._16(72,0,null,0,1,"core-infinite-loading",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.loadMoreEvents(l)&&t}return t},ve.b,ve.a)),E._15(73,573440,null,0,pe.a,[[2,Ln.a],w.a],{enabled:[0,"enabled"],error:[1,"error"]},{action:"action"}),(n()(),E._40(-1,0,["\n        "])),(n()(),E._40(-1,1,["\n\n        "])),(n()(),E._40(-1,1,["\n        "])),(n()(),E._11(16777216,null,0,1,null,p)),E._15(78,16384,null,0,En.k,[E.W,E.T],{ngIf:[0,"ngIf"]},null),(n()(),E._40(-1,1,["\n    "])),(n()(),E._40(-1,0,["\n"]))],function(n,e){var l=e.component;n(e,8,0);n(e,24,0,l.filter.filtered);n(e,27,0,!l.filter.filtered),n(e,31,0);n(e,34,0,E._41(e,34,0,E._29(e,35).transform("core.settings.settings")),"cog",600,!l.notificationsEnabled);n(e,38,0,E._41(e,38,0,E._29(e,39).transform("core.settings.synchronizenow")),l.syncIcon,!1,400,!l.eventsLoaded||!l.hasOffline||!l.isOnline),n(e,46,0);n(e,52,0,l.eventsLoaded);n(e,55,0,E._19(1,"",E._41(e,55,0,E._29(e,56).transform("core.pulltorefresh")),""));n(e,60,0,l.eventsLoaded);n(e,64,0,l.hasOffline);n(e,67,0,!l.filteredEvents||!l.filteredEvents.length);n(e,70,0,l.filteredEvents&&l.filteredEvents.length);n(e,73,0,l.canLoadMore,l.loadMoreError);n(e,78,0,l.canCreate)},function(n,e){n(e,6,0,E._29(e,7)._hidden,E._29(e,7)._sbPadding);n(e,12,0,E._41(e,12,0,E._29(e,13).transform("addon.calendar.calendarevents")));n(e,19,0,E._41(e,19,0,E._29(e,21).transform("core.filter")));n(e,48,0,E._29(e,49).statusbarPadding,E._29(e,49)._hasRefresher);n(e,51,0,"inactive"!==E._29(e,52).state,E._29(e,52)._top);n(e,54,0,E._29(e,55).r.state)})}Object.defineProperty(e,"__esModule",{value:!0});var E=l(1),g=(l(0),l(6),l(4)),b=l(29),I=l(33),y=l(109),O=l(179),C=l(278),D=l(279),T=l(482),x=l(53),L=l(191),w=l(5),S=l(25),A=l(3),N=l(2),k=l(147),P=l(11),$=l(10),K=l(28),R=l(15),W=l(189),M=l(41),V=l(749),U=function(){function n(n,e,l,t,i,a,u,r,o,s,c,d,f,_,h,v,p,m){var E=this;this.calendarProvider=a,this.domUtils=u,this.coursesProvider=r,this.utils=o,this.calendarHelper=s,this.coursesHelper=c,this.eventsProvider=d,this.navCtrl=f,this.appProvider=_,this.calendarOffline=h,this.calendarSync=v,this.timeUtils=p,this.popoverCtrl=m,this.initialTime=0,this.daysLoaded=0,this.emptyEventsTimes=0,this.categoriesRetrieved=!1,this.getCategories=!1,this.categories={},this.onlineEvents=[],this.offlineEvents=[],this.deletedEvents=[],this.eventsLoaded=!1,this.events=[],this.notificationsEnabled=!1,this.filteredEvents=[],this.canLoadMore=!1,this.loadMoreError=!1,this.canCreate=!1,this.hasOffline=!1,this.isOnline=!1,this.filter={filtered:!1,courseId:null,categoryId:null,course:!1,group:!1,site:!1,user:!1,category:!1},this.siteHomeId=e.getCurrentSite().getSiteHomeId(),this.notificationsEnabled=i.isAvailable(),this.currentSiteId=e.getCurrentSiteId(),this.notificationsEnabled&&(this.obsDefaultTimeChange=d.on(O.a.DEFAULT_NOTIFICATION_TIME_CHANGED,function(){a.scheduleEventsNotifications(E.onlineEvents)},this.currentSiteId)),this.eventId=n.get("eventId")||!1,O.a.ALL_TYPES.forEach(function(n){E.filter[n]=!0}),this.filter.courseId=n.get("courseId"),this.newEventObserver=d.on(O.a.NEW_EVENT_EVENT,function(n){n&&n.event&&(E.splitviewCtrl.isOn()&&E.splitviewCtrl.emptyDetails(),E.eventsLoaded=!1,E.refreshEvents(!0,!1).finally(function(){E.splitviewCtrl.isOn()&&n.event.id>0&&E.gotoEvent(n.event.id)}))},this.currentSiteId),this.discardedObserver=d.on(O.a.NEW_EVENT_DISCARDED_EVENT,function(){E.splitviewCtrl.isOn()&&E.splitviewCtrl.emptyDetails(),E.eventsLoaded=!1,E.refreshEvents(!0,!1)},this.currentSiteId),this.editEventObserver=d.on(O.a.EDIT_EVENT_EVENT,function(n){n&&n.event&&(E.eventsLoaded=!1,E.refreshEvents(!0,!1))},this.currentSiteId),this.syncObserver=d.on(T.a.AUTO_SYNCED,function(n){E.eventsLoaded=!1,E.refreshEvents(),E.splitviewCtrl.isOn()&&E.eventId&&n&&n.deleted&&-1!=n.deleted.indexOf(E.eventId)&&E.splitviewCtrl.emptyDetails()},this.currentSiteId),this.manualSyncObserver=d.on(T.a.MANUAL_SYNCED,function(n){n&&"list"!=n.source&&(E.eventsLoaded=!1,E.refreshEvents()),E.splitviewCtrl.isOn()&&E.eventId&&n&&n.deleted&&-1!=n.deleted.indexOf(E.eventId)&&E.splitviewCtrl.emptyDetails()},this.currentSiteId),this.deleteEventObserver=d.on(O.a.DELETED_EVENT_EVENT,function(n){n&&!n.sent?(E.markAsDeleted(n.eventId,!0),E.deletedEvents.push(n.eventId),E.hasOffline=!0):(E.splitviewCtrl.isOn()&&E.splitviewCtrl.emptyDetails(),E.eventsLoaded=!1,E.refreshEvents())},this.currentSiteId),this.undeleteEventObserver=d.on(O.a.UNDELETED_EVENT_EVENT,function(n){if(n&&n.eventId){E.markAsDeleted(n.eventId,!1);var e=E.deletedEvents.indexOf(n.eventId);-1!=e&&E.deletedEvents.splice(e,1),E.hasOffline=!!E.offlineEvents.length||!!E.deletedEvents.length}},this.currentSiteId),this.filterChangedObserver=this.eventsProvider.on(O.a.FILTER_CHANGED_EVENT,function(n){E.filter=n,E.calendarHelper.canEditEvents(E.filter.courseId).then(function(n){E.canCreate=n}),E.filterEvents(),E.domUtils.scrollToTop(E.content)}),this.onlineObserver=l.onchange().subscribe(function(){t.run(function(){E.isOnline=E.appProvider.isOnline()})})}return n.prototype.ionViewDidLoad=function(){var n=this;this.eventId&&this.gotoEvent(this.eventId),this.syncIcon="spinner",this.fetchData(!1,!0,!1).then(function(){!n.eventId&&n.splitviewCtrl.isOn()&&n.events.length>0&&n.gotoEvent(n.onlineEvents[0]?n.onlineEvents[0].id:n.offlineEvents[0].id)})},n.prototype.fetchData=function(n,e,l){var t=this;this.initialTime=this.timeUtils.timestamp(),this.daysLoaded=0,this.emptyEventsTimes=0,this.isOnline=this.appProvider.isOnline();return(e?this.calendarSync.syncEvents().then(function(n){n.warnings&&n.warnings.length&&t.domUtils.showErrorModal(n.warnings[0]),n.updated&&(n.source="list",t.eventsProvider.trigger(T.a.MANUAL_SYNCED,n,t.currentSiteId))}).catch(function(n){l&&t.domUtils.showErrorModalDefault(n,"core.errorsync",!0)}):Promise.resolve()).then(function(){var e=[];return t.hasOffline=!1,e.push(t.calendarHelper.canEditEvents(t.filter.courseId).then(function(n){t.canCreate=n})),e.push(t.coursesHelper.getCoursesForPopover(t.filter.courseId).then(function(e){return t.courses=e.courses,t.fetchEvents(n)})),e.push(t.calendarOffline.getAllEditedEvents().then(function(n){t.hasOffline=t.hasOffline||!!n.length,n.forEach(function(n){n.offline=!0,t.calendarHelper.formatEventData(n)}),t.offlineEvents=t.sortEvents(n)})),e.push(t.calendarOffline.getAllDeletedEventsIds().then(function(n){t.hasOffline=t.hasOffline||!!n.length,t.deletedEvents=n})),Promise.all(e)}).finally(function(){t.eventsLoaded=!0,t.syncIcon="sync"})},n.prototype.fetchEvents=function(n){var e=this;return this.loadMoreError=!1,this.calendarProvider.getEventsList(this.initialTime,this.daysLoaded,O.a.DAYS_INTERVAL).then(function(l){if(0===l.length){if(e.emptyEventsTimes++,!(e.emptyEventsTimes>5))return e.daysLoaded+=O.a.DAYS_INTERVAL,e.fetchEvents();e.canLoadMore=!1,n&&(e.onlineEvents=[],e.filteredEvents=[],e.events=e.offlineEvents)}else{l.forEach(e.calendarHelper.formatEventData.bind(e.calendarHelper));var t=e.mergeEvents(l);e.getCategories=e.shouldLoadCategories(l),n?(e.onlineEvents=l,e.events=t):(e.onlineEvents=e.utils.mergeArraysWithoutDuplicates(e.onlineEvents,l,"id"),e.events=e.utils.mergeArraysWithoutDuplicates(e.events,t,"id")),e.filterEvents(),e.filteredEvents.forEach(function(n,l){n.showDate=e.showDate(n,e.filteredEvents[l-1]),n.endsSameDay=e.endsSameDay(n)}),e.canLoadMore=!0,e.calendarProvider.scheduleEventsNotifications(e.onlineEvents),e.daysLoaded+=O.a.DAYS_INTERVAL}e.content.resize()}).catch(function(n){e.domUtils.showErrorModalDefault(n,"addon.calendar.errorloadevents",!0),e.loadMoreError=!0}).then(function(){if(e.getCategories)return e.getCategories=!1,e.loadCategories()})},n.prototype.loadMoreEvents=function(n){return this.fetchEvents().finally(function(){n&&n()})},n.prototype.filterEvents=function(){this.filteredEvents=this.calendarHelper.getFilteredEvents(this.events,this.filter,this.categories)},n.prototype.shouldLoadCategories=function(n){if(this.categoriesRetrieved||this.getCategories)return this.getCategories;return n.some(function(n){return"undefined"!=n.categoryid&&n.categoryid>0})||this.getCategories},n.prototype.loadCategories=function(){var n=this;return this.coursesProvider.getCategories(0,!0).then(function(e){n.categoriesRetrieved=!0,n.categories={},e.forEach(function(e){n.categories[e.id]=e})}).catch(function(){})},n.prototype.mergeEvents=function(n){var e=this;if(!this.offlineEvents.length&&!this.deletedEvents.length)return n;var l=this.initialTime+M.a.SECONDS_DAY*this.daysLoaded,t=l+M.a.SECONDS_DAY*O.a.DAYS_INTERVAL-1,i=n;this.deletedEvents.length&&i.forEach(function(n){n.deleted=-1!=e.deletedEvents.indexOf(n.id)}),this.offlineEvents.length&&(i=i.filter(function(n){return!e.offlineEvents.find(function(e){return e.id==n.id})}));var a=this.offlineEvents.filter(function(n){return 0==e.daysLoaded&&n.timestart<l||(n.timestart>=l||n.timestart+n.timeduration>=l)&&n.timestart<=t});return i=i.concat(a),this.sortEvents(i)},n.prototype.sortEvents=function(n){return n.sort(function(n,e){return n.timestart==e.timestart?n.timeduration-e.timeduration:n.timestart-e.timestart})},n.prototype.doRefresh=function(n,e,l){return this.eventsLoaded?this.refreshEvents(!0,l).finally(function(){n&&n.complete(),e&&e()}):Promise.resolve()},n.prototype.refreshEvents=function(n,e){var l=this;this.syncIcon="spinner";var t=[];return t.push(this.calendarProvider.invalidateEventsList()),t.push(this.calendarProvider.invalidateAllowedEventTypes()),this.categoriesRetrieved&&(t.push(this.coursesProvider.invalidateCategories(0,!0)),this.categoriesRetrieved=!1),Promise.all(t).finally(function(){return l.fetchData(!0,n,e)})},n.prototype.showDate=function(n,e){return!e||!R(1e3*n.timestart).isSame(1e3*e.timestart,"day")},n.prototype.endsSameDay=function(n){return!n.timeduration||R(1e3*n.timestart).isSame(1e3*(n.timestart+n.timeduration),"day")},n.prototype.openFilter=function(n){this.popoverCtrl.create(V.a,{courses:this.courses,filter:this.filter}).present({ev:n})},n.prototype.openEdit=function(n){this.eventId=void 0;var e={};n&&(e.eventId=n),this.filter.courseId&&(e.courseId=this.filter.courseId),this.splitviewCtrl.push("AddonCalendarEditEventPage",e)},n.prototype.openSettings=function(){this.navCtrl.push("AddonCalendarSettingsPage")},n.prototype.gotoEvent=function(n){this.eventId=n,n<0?this.openEdit(n):this.splitviewCtrl.push("AddonCalendarEventPage",{id:n})},n.prototype.markAsDeleted=function(n,e){var l=this.onlineEvents.find(function(e){return e.id==n});l&&(l.deleted=e)},n.prototype.ngOnDestroy=function(){this.obsDefaultTimeChange&&this.obsDefaultTimeChange.off(),this.newEventObserver&&this.newEventObserver.off(),this.discardedObserver&&this.discardedObserver.off(),this.editEventObserver&&this.editEventObserver.off(),this.deleteEventObserver&&this.deleteEventObserver.off(),this.undeleteEventObserver&&this.undeleteEventObserver.off(),this.syncObserver&&this.syncObserver.off(),this.manualSyncObserver&&this.manualSyncObserver.off(),this.filterChangedObserver&&this.filterChangedObserver.off(),this.onlineObserver&&this.onlineObserver.unsubscribe()},n}(),H=function(){return function(){}}(),F=l(1524),Y=l(1525),j=l(1526),z=l(1527),B=l(1528),G=l(1529),J=l(1530),q=l(1531),Q=l(1532),X=l(1533),Z=l(1534),nn=l(1535),en=l(1536),ln=l(48),tn=l(9),an=l(92),un=l(26),rn=l(18),on=l(128),sn=l(117),cn=l(31),dn=l(21),fn=l(20),_n=l(27),hn=l(103),vn=l(91),pn=l(84),mn=l(252),En=l(8),gn=l(34),bn=l(49),In=l(12),yn=l(17),On=l(23),Cn=l(7),Dn=l(19),Tn=l(16),xn=l(22),Ln=l(30),wn=l(44),Sn=l(43),An=l(32),Nn=l(37),kn=l(90),Pn=l(45),$n=l(35),Kn=l(284),Rn=l(259),Wn=l(219),Mn=l(285),Vn=l(193),Un=l(230),Hn=l(375),Fn=l(40),Yn=l(725),jn=l(214),zn=l(36),Bn=l(478),Gn=l(726),Jn=l(316),qn=l(251),Qn=l(376),Xn=l(46),Zn=l(42),ne=l(94),ee=l(80),le=l(72),te=l(78),ie=l(95),ae=l(85),ue=l(479),re=l(74),oe=l(186),se=l(110),ce=l(162),de=l(215),fe=l(176),_e=l(55),he=l(52),ve=l(377),pe=l(276),me=l(71),Ee=E._14({encapsulation:2,styles:[],data:{}}),ge=E._12("page-addon-calendar-list",U,function(n){return E._42(0,[(n()(),E._16(0,0,null,null,1,"page-addon-calendar-list",[],null,null,null,m,Ee)),E._15(1,180224,null,0,U,[me.a,N.a,W.a,E.D,k.a,O.a,w.a,x.a,A.a,D.a,L.a,P.a,xn.a,$.a,C.a,T.a,S.a,le.a],null,null)],null,null)},{},{},[]),be=l(24),Ie=l(371),ye=l(372),Oe=l(374),Ce=l(373),De=l(477),Te=l(724),xe=l(274);l.d(e,"AddonCalendarListPageModuleNgFactory",function(){return Le});var Le=E._13(H,[],function(n){return E._25([E._26(512,E.n,E._6,[[8,[F.a,Y.a,j.a,z.a,B.a,G.a,J.a,q.a,Q.a,X.a,Z.a,nn.a,en.a,ge]],[3,E.n],E.B]),E._26(4608,En.m,En.l,[E.x,[2,En.w]]),E._26(4608,be.x,be.x,[]),E._26(4608,be.d,be.d,[]),E._26(4608,Ie.b,Ie.a,[]),E._26(4608,ye.a,ye.b,[]),E._26(4608,Oe.b,Oe.a,[]),E._26(4608,Ce.b,Ce.a,[]),E._26(4608,rn.a,rn.a,[De.a,Ie.b,ye.a,Oe.b,Ce.b,rn.b,rn.c]),E._26(512,En.b,En.b,[]),E._26(512,be.v,be.v,[]),E._26(512,be.i,be.i,[]),E._26(512,be.s,be.s,[]),E._26(512,Te.a,Te.a,[]),E._26(512,g.a,g.a,[]),E._26(512,I.a,I.a,[]),E._26(512,y.a,y.a,[]),E._26(512,b.a,b.a,[]),E._26(512,Te.b,Te.b,[]),E._26(512,H,H,[]),E._26(256,rn.c,void 0,[]),E._26(256,rn.b,void 0,[]),E._26(256,xe.a,U,[])])})}});