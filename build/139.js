webpackJsonp([139],{2155:function(n,l,e){"use strict";function t(n){return y._42(0,[(n()(),y._16(0,0,null,null,1,"ion-icon",[["name","funnel"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(1,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"funnel")},function(n,l){n(l,0,0,y._29(l,1)._hidden)})}function a(n){return y._42(0,[(n()(),y._16(0,0,null,null,1,"ion-icon",[["name","ios-funnel-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(1,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"ios-funnel-outline")},function(n,l){n(l,0,0,y._29(l,1)._hidden)})}function i(n){return y._42(0,[(n()(),y._16(0,0,null,null,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.goToCurrentDay()&&t}return t},ln.b,ln.a)),y._15(1,770048,null,0,en.a,[tn.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"]},{action:"action"}),y._32(131072,an.a,[un.a,y.i])],function(n,l){n(l,1,0,y._41(l,1,0,y._29(l,2).transform("addon.calendar.today")),"fa-calendar-times-o",900)},null)}function u(n){return y._42(0,[(n()(),y._16(0,0,null,null,10,"ion-col",[["class","col"],["text-start",""]],null,null,null,null,null)),y._15(1,16384,null,0,rn.a,[],null,null),(n()(),y._40(-1,null,["\n                "])),(n()(),y._16(3,0,null,null,6,"a",[["clear",""],["icon-only",""],["ion-button",""]],[[8,"title",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.loadPrevious()&&t}return t},on.b,on.a)),y._15(4,1097728,null,0,sn.a,[[8,""],nn.a,y.p,y.K],{clear:[0,"clear"]},null),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,0,["\n                    "])),(n()(),y._16(7,0,null,0,1,"ion-icon",[["md","ios-arrow-back"],["name","arrow-back"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(8,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"],md:[1,"md"]},null),(n()(),y._40(-1,0,["\n                "])),(n()(),y._40(-1,null,["\n            "]))],function(n,l){n(l,4,0,"");n(l,8,0,"arrow-back","ios-arrow-back")},function(n,l){n(l,3,0,y._41(l,3,0,y._29(l,5).transform("addon.calendar.dayprev")));n(l,7,0,y._29(l,8)._hidden)})}function r(n){return y._42(0,[(n()(),y._16(0,0,null,null,10,"ion-col",[["class","col"],["text-end",""]],null,null,null,null,null)),y._15(1,16384,null,0,rn.a,[],null,null),(n()(),y._40(-1,null,["\n                "])),(n()(),y._16(3,0,null,null,6,"a",[["clear",""],["icon-only",""],["ion-button",""]],[[8,"title",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.loadNext()&&t}return t},on.b,on.a)),y._15(4,1097728,null,0,sn.a,[[8,""],nn.a,y.p,y.K],{clear:[0,"clear"]},null),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,0,["\n                    "])),(n()(),y._16(7,0,null,0,1,"ion-icon",[["md","ios-arrow-forward"],["name","arrow-forward"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(8,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"],md:[1,"md"]},null),(n()(),y._40(-1,0,["\n                "])),(n()(),y._40(-1,null,["\n            "]))],function(n,l){n(l,4,0,"");n(l,8,0,"arrow-forward","ios-arrow-forward")},function(n,l){n(l,3,0,y._41(l,3,0,y._29(l,5).transform("addon.calendar.daynext")));n(l,7,0,y._29(l,8)._hidden)})}function o(n){return y._42(0,[(n()(),y._16(0,0,null,null,8,"ion-card",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),y._15(1,16384,null,0,cn.a,[nn.a,y.p,y.K],null,null),(n()(),y._40(-1,null,["\n            "])),(n()(),y._16(3,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(4,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"]},null),(n()(),y._40(5,null,[" ","\n        "])),y._32(131072,an.a,[un.a,y.i]),y._33(7,{$a:0}),y._32(131072,an.a,[un.a,y.i])],function(n,l){n(l,4,0,"warning")},function(n,l){n(l,3,0,y._29(l,4)._hidden);n(l,5,0,y._41(l,5,0,y._29(l,8).transform("core.hasdatatosync",n(l,7,0,y._41(l,5,0,y._29(l,6).transform("core.day"))))))})}function s(n){return y._42(0,[(n()(),y._16(0,0,null,null,3,"core-empty-box",[["icon","calendar"]],null,null,null,dn.b,dn.a)),y._15(1,49152,null,0,fn.a,[],{message:[0,"message"],icon:[1,"icon"]},null),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,0,["\n        "]))],function(n,l){n(l,1,0,y._41(l,1,0,y._29(l,2).transform("addon.calendar.noevents")),"calendar")},null)}function c(n){return y._42(0,[(n()(),y._16(0,0,null,null,0,"img",[["class","core-module-icon"],["item-start",""]],[[8,"src",4]],null,null,null,null))],null,function(n,l){n(l,0,0,y._19(1,"",l.parent.context.$implicit.moduleIcon,""))})}function d(n){return y._42(0,[(n()(),y._16(0,0,null,null,1,"core-icon",[["item-start",""]],null,null,null,hn.b,hn.a)),y._15(1,704512,null,0,_n.a,[y.p,nn.a],{name:[0,"name"]},null)],function(n,l){n(l,1,0,l.parent.context.$implicit.eventIcon)},null)}function f(n){return y._42(0,[(n()(),y._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),y._15(1,16384,null,0,vn.a,[nn.a,y.p,y.K],null,null),(n()(),y._40(-1,null,["\n                        "])),(n()(),y._16(3,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(4,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"]},null),(n()(),y._40(-1,null,["\n                        "])),(n()(),y._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),y._40(7,null,["",""])),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,null,["\n                    "]))],function(n,l){n(l,4,0,"time")},function(n,l){n(l,3,0,y._29(l,4)._hidden);n(l,7,0,y._41(l,7,0,y._29(l,8).transform("core.notsent")))})}function h(n){return y._42(0,[(n()(),y._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),y._15(1,16384,null,0,vn.a,[nn.a,y.p,y.K],null,null),(n()(),y._40(-1,null,["\n                        "])),(n()(),y._16(3,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(4,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"]},null),(n()(),y._40(-1,null,["\n                        "])),(n()(),y._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),y._40(7,null,["",""])),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,null,["\n                    "]))],function(n,l){n(l,4,0,"trash")},function(n,l){n(l,3,0,y._29(l,4)._hidden);n(l,7,0,y._41(l,7,0,y._29(l,8).transform("core.deletedoffline")))})}function _(n){return y._42(0,[(n()(),y._16(0,0,null,null,29,null,null,null,null,null,null,null)),(n()(),y._40(-1,null,["\n                "])),(n()(),y._16(2,0,null,null,26,"ion-item",[["class","addon-calendar-event item item-block"],["text-wrap",""]],[[8,"title",0],[2,"item-dimmed",null]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.gotoEvent(n.context.$implicit.id)&&t}return t},mn.b,mn.a)),y._15(3,278528,null,0,pn.i,[y.v,y.w,y.p,y.L],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),y._31(4,1),y._15(5,1097728,null,3,yn.a,[En.a,nn.a,y.p,y.K,[2,gn.a]],null,null),y._37(335544320,2,{contentLabel:0}),y._37(603979776,3,{_buttons:1}),y._37(603979776,4,{_icons:1}),y._15(9,16384,null,0,bn.a,[],null,null),(n()(),y._40(-1,2,["\n                    "])),(n()(),y._11(16777216,null,0,1,null,c)),y._15(12,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,2,["\n                    "])),(n()(),y._11(16777216,null,0,1,null,d)),y._15(15,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,2,["\n                    "])),(n()(),y._16(17,0,null,2,2,"h2",[],null,null,null,null,null)),(n()(),y._16(18,16777216,null,null,1,"core-format-text",[],null,null,null,null,null)),y._15(19,540672,null,0,In.a,[y.p,C.a,x.a,Dn.a,un.a,On.a,Tn.a,Cn.a,xn.a,wn.a,D.a,Pn.a,[2,kn.a],[2,Mn.a],[2,Nn.a],An.a,O.a,Kn.a,Sn.a,Fn.a,y.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"]},null),(n()(),y._40(-1,2,["\n                    "])),(n()(),y._16(21,0,null,2,0,"p",[],[[8,"innerHTML",1]],null,null,null,null)),(n()(),y._40(-1,2,["\n                    "])),(n()(),y._11(16777216,null,4,1,null,f)),y._15(24,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,2,["\n                    "])),(n()(),y._11(16777216,null,4,1,null,h)),y._15(27,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,2,["\n                "])),(n()(),y._40(-1,null,["\n            "]))],function(n,l){n(l,3,0,"addon-calendar-event",n(l,4,0,"addon-calendar-eventtype-"+l.context.$implicit.eventtype));n(l,12,0,l.context.$implicit.moduleIcon);n(l,15,0,l.context.$implicit.eventIcon&&!l.context.$implicit.moduleIcon);n(l,19,0,l.context.$implicit.name,l.context.$implicit.contextLevel,l.context.$implicit.contextInstanceId);n(l,24,0,l.context.$implicit.offline&&!l.context.$implicit.deleted);n(l,27,0,l.context.$implicit.deleted)},function(n,l){n(l,2,0,l.context.$implicit.name,l.context.$implicit.ispast);n(l,21,0,l.context.$implicit.formattedtime)})}function v(n){return y._42(0,[(n()(),y._16(0,0,null,null,5,"ion-list",[["no-margin",""]],null,null,null,null,null)),y._15(1,16384,null,0,Ln.a,[nn.a,y.p,y.K,On.a,Un.l,Wn.a],null,null),(n()(),y._40(-1,null,["\n            "])),(n()(),y._11(16777216,null,null,1,null,_)),y._15(4,802816,null,0,pn.j,[y.W,y.T,y.v],{ngForOf:[0,"ngForOf"]},null),(n()(),y._40(-1,null,["\n        "]))],function(n,l){n(l,4,0,l.component.filteredEvents)},null)}function m(n){return y._42(0,[(n()(),y._16(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,$n.b,$n.a)),y._15(1,212992,null,0,Hn.a,[y.p,Mn.a],null,null),y._15(2,1228800,null,2,Vn.a,[On.a],null,null),y._37(335544320,5,{_mainButton:0}),y._37(603979776,6,{_fabLists:1}),(n()(),y._40(-1,0,["\n            "])),(n()(),y._16(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.openEdit()&&t}return t},Yn.b,Yn.a)),y._15(7,49152,[[5,4]],0,Rn.a,[nn.a,y.p,y.K],null,null),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,0,["\n                "])),(n()(),y._16(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._15(11,147456,null,0,Z.a,[nn.a,y.p,y.K],{name:[0,"name"]},null),(n()(),y._40(-1,0,["\n            "])),(n()(),y._40(-1,0,["\n        "]))],function(n,l){n(l,1,0);n(l,11,0,"add")},function(n,l){n(l,6,0,y._41(l,6,0,y._29(l,8).transform("addon.calendar.newevent")));n(l,10,0,y._29(l,11)._hidden)})}function p(n){return y._42(0,[(n()(),y._16(0,0,null,null,39,"ion-header",[],null,null,null,null,null)),y._15(1,16384,null,0,jn.a,[nn.a,y.p,y.K,[2,Bn.a]],null,null),(n()(),y._40(-1,null,["\n    "])),(n()(),y._16(3,0,null,null,35,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Gn.b,Gn.a)),y._15(4,49152,null,0,zn.a,[Jn.a,[2,Bn.a],[2,kn.a],nn.a,y.p,y.K],null,null),y._15(5,212992,null,0,qn.a,[zn.a,On.a,un.a,O.a],null,null),(n()(),y._40(-1,3,["\n        "])),(n()(),y._16(7,0,null,3,3,"ion-title",[],null,null,null,Qn.b,Qn.a)),y._15(8,49152,null,0,Xn.a,[nn.a,y.p,y.K,[2,Zn.a],[2,zn.a]],null,null),(n()(),y._40(9,0,["",""])),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,3,["\n        "])),(n()(),y._16(12,0,null,2,25,"ion-buttons",[["end",""]],null,null,null,null,null)),y._15(13,16384,null,1,nl.a,[nn.a,y.p,y.K,[2,Zn.a],[2,zn.a]],null,null),y._37(603979776,1,{_buttons:1}),(n()(),y._40(-1,null,["\n            "])),(n()(),y._16(16,0,null,null,9,"button",[["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.openFilter(e)&&t}return t},on.b,on.a)),y._15(17,1097728,[[1,4]],0,sn.a,[[8,""],nn.a,y.p,y.K],null,null),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,0,["\n                "])),(n()(),y._11(16777216,null,0,1,null,t)),y._15(21,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n                "])),(n()(),y._11(16777216,null,0,1,null,a)),y._15(24,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n            "])),(n()(),y._40(-1,null,["\n            "])),(n()(),y._16(27,0,null,null,9,"core-context-menu",[],null,null,null,ll.b,ll.a)),y._15(28,245760,null,0,tn.a,[un.a,el.a,y.p,x.a,[2,tl.a],Tn.a],null,null),(n()(),y._40(-1,0,["\n                "])),(n()(),y._11(16777216,null,0,1,null,i)),y._15(31,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n                "])),(n()(),y._16(33,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.doRefresh(null,e,!0)&&t}return t},ln.b,ln.a)),y._15(34,770048,null,0,en.a,[tn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,0,["\n            "])),(n()(),y._40(-1,null,["\n        "])),(n()(),y._40(-1,3,["\n    "])),(n()(),y._40(-1,null,["\n"])),(n()(),y._40(-1,null,["\n"])),(n()(),y._16(41,0,null,null,50,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,al.b,al.a)),y._15(42,4374528,null,0,Mn.a,[nn.a,On.a,Wn.a,y.p,y.K,Jn.a,il.a,y.D,[2,Bn.a],[2,kn.a]],null,null),(n()(),y._40(-1,1,["\n    "])),(n()(),y._16(44,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,l,e){var t=!0;if("ionRefresh"===l){t=!1!==n.component.doRefresh(e)&&t}return t},null,null)),y._15(45,212992,null,0,ul.a,[On.a,Mn.a,y.D,Un.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),y._40(-1,null,["\n        "])),(n()(),y._16(47,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,rl.b,rl.a)),y._15(48,114688,null,0,ol.a,[ul.a,nn.a],{pullingText:[0,"pullingText"]},null),y._32(131072,an.a,[un.a,y.i]),(n()(),y._40(-1,null,["\n    "])),(n()(),y._40(-1,1,["\n\n    "])),(n()(),y._40(-1,1,["\n    "])),(n()(),y._16(53,0,null,1,19,"ion-grid",[["class","safe-area-page grid"],["padding-top",""]],null,null,null,null,null)),y._15(54,16384,null,0,sl.a,[],null,null),(n()(),y._40(-1,null,["\n        "])),(n()(),y._16(56,0,null,null,15,"ion-row",[["class","row"]],null,null,null,null,null)),y._15(57,16384,null,0,cl.a,[],null,null),(n()(),y._40(-1,null,["\n            "])),(n()(),y._11(16777216,null,null,1,null,u)),y._15(60,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,null,["\n            "])),(n()(),y._16(62,0,null,null,5,"ion-col",[["class","addon-calendar-period col"],["text-center",""]],null,null,null,null,null)),y._15(63,16384,null,0,rn.a,[],null,null),(n()(),y._40(-1,null,["\n                "])),(n()(),y._16(65,0,null,null,1,"h3",[],null,null,null,null,null)),(n()(),y._40(66,null,["",""])),(n()(),y._40(-1,null,["\n            "])),(n()(),y._40(-1,null,["\n            "])),(n()(),y._11(16777216,null,null,1,null,r)),y._15(70,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,null,["\n        "])),(n()(),y._40(-1,null,["\n    "])),(n()(),y._40(-1,1,["\n\n    "])),(n()(),y._16(74,0,null,1,16,"core-loading",[["class","safe-area-page"]],null,null,null,dl.b,dl.a)),y._15(75,638976,null,0,fl.a,[un.a,y.p,O.a,Tn.a],{hideUntil:[0,"hideUntil"]},null),(n()(),y._40(-1,0,["\n        "])),(n()(),y._40(-1,0,["\n        "])),(n()(),y._11(16777216,null,0,1,null,o)),y._15(79,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n\n        "])),(n()(),y._11(16777216,null,0,1,null,s)),y._15(82,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n\n        "])),(n()(),y._11(16777216,null,0,1,null,v)),y._15(85,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n\n        "])),(n()(),y._40(-1,0,["\n        "])),(n()(),y._11(16777216,null,0,1,null,m)),y._15(89,16384,null,0,pn.k,[y.W,y.T],{ngIf:[0,"ngIf"]},null),(n()(),y._40(-1,0,["\n    "])),(n()(),y._40(-1,1,["\n"])),(n()(),y._40(-1,null,["\n"]))],function(n,l){var e=l.component;n(l,5,0);n(l,21,0,e.filter.filtered);n(l,24,0,!e.filter.filtered),n(l,28,0);n(l,31,0,!e.isCurrentDay);n(l,34,0,y._41(l,34,0,y._29(l,35).transform("core.settings.synchronizenow")),e.syncIcon,!1,400,!e.loaded||!e.hasOffline||!e.isOnline);n(l,45,0,e.loaded);n(l,48,0,y._19(1,"",y._41(l,48,0,y._29(l,49).transform("core.pulltorefresh")),""));n(l,60,0,e.currentMoment);n(l,70,0,e.currentMoment);n(l,75,0,e.loaded);n(l,79,0,e.hasOffline);n(l,82,0,!e.filteredEvents||!e.filteredEvents.length);n(l,85,0,e.filteredEvents&&e.filteredEvents.length);n(l,89,0,e.canCreate)},function(n,l){var e=l.component;n(l,3,0,y._29(l,4)._hidden,y._29(l,4)._sbPadding);n(l,9,0,y._41(l,9,0,y._29(l,10).transform("addon.calendar.calendarevents")));n(l,16,0,y._41(l,16,0,y._29(l,18).transform("core.filter")));n(l,41,0,y._29(l,42).statusbarPadding,y._29(l,42)._hasRefresher);n(l,44,0,"inactive"!==y._29(l,45).state,y._29(l,45)._top);n(l,47,0,y._29(l,48).r.state);n(l,66,0,e.periodName)})}Object.defineProperty(l,"__esModule",{value:!0});var y=e(1),E=(e(0),e(6),e(4)),g=e(29),b=e(33),I=e(109),D=e(10),O=e(11),T=e(147),C=e(2),x=e(5),w=e(25),P=e(179),k=e(278),M=e(279),N=e(482),A=e(53),K=e(191),S=e(749),F=e(189),L=e(15),U=function(){function n(n,l,e,t,a,i,u,r,o,s,c,d,f,h,_,v,m){var p=this;this.navCtrl=i,this.domUtils=u,this.timeUtils=r,this.calendarProvider=o,this.calendarOffline=s,this.calendarHelper=c,this.calendarSync=d,this.eventsProvider=f,this.coursesProvider=h,this.coursesHelper=_,this.appProvider=v,this.popoverCtrl=m,this.categories={},this.events=[],this.onlineEvents=[],this.offlineEvents={},this.offlineEditedEventsIds=[],this.deletedEvents=[],this.filteredEvents=[],this.canCreate=!1,this.loaded=!1,this.hasOffline=!1,this.isOnline=!1,this.filter={filtered:!1,courseId:null,categoryId:null,course:!0,group:!0,site:!0,user:!0,category:!0};var y=new Date;P.a.ALL_TYPES.forEach(function(n){p.filter[n]=l.get(n),p.filter[n]=void 0===p.filter[n]||p.filter[n]}),this.filter.courseId=l.get("courseId"),this.filter.categoryId=l.get("categoryId"),this.filter.filtered=!!this.filter.courseId||P.a.ALL_TYPES.some(function(n){return!p.filter[n]}),this.year=l.get("year")||y.getFullYear(),this.month=l.get("month")||y.getMonth()+1,this.day=l.get("day")||y.getDate(),this.currentSiteId=a.getCurrentSiteId(),n.isAvailable()&&(this.obsDefaultTimeChange=f.on(P.a.DEFAULT_NOTIFICATION_TIME_CHANGED,function(){o.scheduleEventsNotifications(p.onlineEvents)},this.currentSiteId)),this.newEventObserver=f.on(P.a.NEW_EVENT_EVENT,function(n){n&&n.event&&(p.loaded=!1,p.refreshData(!0,!1,!0))},this.currentSiteId),this.discardedObserver=f.on(P.a.NEW_EVENT_DISCARDED_EVENT,function(){p.loaded=!1,p.refreshData(!0,!1,!0)},this.currentSiteId),this.editEventObserver=f.on(P.a.EDIT_EVENT_EVENT,function(n){n&&n.event&&(p.loaded=!1,p.refreshData(!0,!1,!0))},this.currentSiteId),this.syncObserver=f.on(N.a.AUTO_SYNCED,function(n){p.loaded=!1,p.refreshData(!1,!1,!0)},this.currentSiteId),this.manualSyncObserver=f.on(N.a.MANUAL_SYNCED,function(n){!n||"day"==n.source&&n.year==p.year&&n.month==p.month&&n.day==p.day||(p.loaded=!1,p.refreshData(!1,!1,!0))},this.currentSiteId),this.deleteEventObserver=f.on(P.a.DELETED_EVENT_EVENT,function(n){n&&!n.sent?(p.hasOffline=p.markAsDeleted(n.eventId,!0)||p.hasOffline,p.deletedEvents.push(n.eventId)):(p.loaded=!1,p.refreshData(!1,!1,!0))},this.currentSiteId),this.undeleteEventObserver=f.on(P.a.UNDELETED_EVENT_EVENT,function(n){if(n&&n.eventId){var l=p.markAsDeleted(n.eventId,!1),e=p.deletedEvents.indexOf(n.eventId);if(-1!=e&&p.deletedEvents.splice(e,1),l)if(p.hasOffline=!1,p.events.length!=p.onlineEvents.length)p.hasOffline=!0;else{var t=p.events.find(function(n){return n.deleted||n.offline});p.hasOffline=!!t}}},this.currentSiteId),this.filterChangedObserver=this.eventsProvider.on(P.a.FILTER_CHANGED_EVENT,function(n){p.filter=n,p.calendarHelper.canEditEvents(p.filter.courseId).then(function(n){p.canCreate=n}),p.filterEvents()}),this.onlineObserver=e.onchange().subscribe(function(){t.run(function(){p.isOnline=p.appProvider.isOnline()})})}return n.prototype.ngOnInit=function(){this.calculateCurrentMoment(),this.calculateIsCurrentDay(),this.fetchData(!0,!1)},n.prototype.fetchData=function(n,l){var e=this;this.syncIcon="spinner",this.isOnline=this.appProvider.isOnline();return(n?this.sync():Promise.resolve()).then(function(){var n=[];return n.push(e.coursesHelper.getCoursesForPopover(e.filter.courseId).then(function(n){e.courses=n.courses})),n.push(e.loadCategories()),n.push(e.calendarOffline.getAllEditedEvents().then(function(n){n.forEach(function(n){n.offline=!0,e.calendarHelper.formatEventData(n)}),e.offlineEvents=e.calendarHelper.classifyIntoMonths(n);var l=n.filter(function(n){return n.id>0});e.offlineEditedEventsIds=l.map(function(n){return n.id})})),n.push(e.calendarOffline.getAllDeletedEventsIds().then(function(n){e.deletedEvents=n})),n.push(e.calendarHelper.canEditEvents(e.filter.courseId).then(function(n){e.canCreate=n})),n.push(e.calendarProvider.getCalendarTimeFormat().then(function(n){e.timeFormat=n})),Promise.all(n)}).then(function(){return e.fetchEvents()}).catch(function(n){e.domUtils.showErrorModalDefault(n,"addon.calendar.errorloadevents",!0)}).finally(function(){e.loaded=!0,e.syncIcon="sync"})},n.prototype.fetchEvents=function(){var n=this;return this.calendarProvider.getDayEvents(this.year,this.month,this.day).catch(function(l){return n.appProvider.isOnline()?Promise.reject(l):Promise.resolve({events:[]})}).then(function(l){var e=[];n.periodName=n.timeUtils.userDate(new Date(n.year,n.month-1,n.day).getTime(),"core.strftimedaydate"),n.onlineEvents=l.events,n.onlineEvents.forEach(n.calendarHelper.formatEventData.bind(n.calendarHelper)),n.calendarProvider.scheduleEventsNotifications(n.onlineEvents),n.events=n.mergeEvents(),n.filterEvents(),n.calculateIsCurrentDay();var t=1e3*n.currentMoment.unix();return n.events.forEach(function(l){l.ispast=n.isPastDay||n.isCurrentDay&&n.isEventPast(l),e.push(n.calendarProvider.formatEventTime(l,n.timeFormat,!0,t).then(function(n){l.formattedtime=n}))}),Promise.all(e)})},n.prototype.mergeEvents=function(){var n=this;if(this.hasOffline=!1,!Object.keys(this.offlineEvents).length&&!this.deletedEvents.length)return this.onlineEvents;var l=this.offlineEvents[this.calendarHelper.getMonthId(this.year,this.month)],e=l&&l[this.day],t=this.onlineEvents;return this.deletedEvents.length&&t.forEach(function(l){l.deleted=-1!=n.deletedEvents.indexOf(l.id),l.deleted&&(n.hasOffline=!0)}),this.offlineEditedEventsIds.length&&(t=t.filter(function(l){return-1==n.offlineEditedEventsIds.indexOf(l.id)})).length!=this.onlineEvents.length&&(this.hasOffline=!0),e&&e.length&&(this.hasOffline=!0,t=this.sortEvents(t.concat(e))),t},n.prototype.filterEvents=function(){this.filteredEvents=this.calendarHelper.getFilteredEvents(this.events,this.filter,this.categories)},n.prototype.sortEvents=function(n){return n.sort(function(n,l){return n.timestart==l.timestart?n.timeduration-l.timeduration:n.timestart-l.timestart})},n.prototype.doRefresh=function(n,l,e){return this.loaded?this.refreshData(!0,e).finally(function(){n&&n.complete(),l&&l()}):Promise.resolve()},n.prototype.refreshData=function(n,l,e){var t=this;this.syncIcon="spinner";var a=[];return e||a.push(this.calendarProvider.invalidateDayEvents(this.year,this.month,this.day)),a.push(this.calendarProvider.invalidateAllowedEventTypes()),a.push(this.coursesProvider.invalidateCategories(0,!0)),a.push(this.calendarProvider.invalidateTimeFormat()),Promise.all(a).finally(function(){return t.fetchData(n,l)})},n.prototype.loadCategories=function(){var n=this;return this.coursesProvider.getCategories(0,!0).then(function(l){n.categories={},l.forEach(function(l){n.categories[l.id]=l})}).catch(function(){})},n.prototype.sync=function(n){var l=this;return this.calendarSync.syncEvents().then(function(n){n.warnings&&n.warnings.length&&l.domUtils.showErrorModal(n.warnings[0]),n.updated&&(n.source="day",n.day=l.day,n.month=l.month,n.year=l.year,l.eventsProvider.trigger(N.a.MANUAL_SYNCED,n,l.currentSiteId))}).catch(function(e){n&&l.domUtils.showErrorModalDefault(e,"core.errorsync",!0)})},n.prototype.gotoEvent=function(n){n<0?this.openEdit(n):this.navCtrl.push("AddonCalendarEventPage",{id:n})},n.prototype.openFilter=function(n){this.popoverCtrl.create(S.a,{courses:this.courses,filter:this.filter}).present({ev:n})},n.prototype.openEdit=function(n){var l={};n?l.eventId=n:l.timestamp=1e3*L().year(this.year).month(this.month-1).date(this.day).unix(),this.filter.courseId&&(l.courseId=this.filter.courseId),this.navCtrl.push("AddonCalendarEditEventPage",l)},n.prototype.calculateCurrentMoment=function(){this.currentMoment=L().year(this.year).month(this.month-1).date(this.day)},n.prototype.calculateIsCurrentDay=function(){var n=new Date;this.currentTime=this.timeUtils.timestamp(),this.isCurrentDay=this.year==n.getFullYear()&&this.month==n.getMonth()+1&&this.day==n.getDate(),this.isPastDay=this.year<n.getFullYear()||this.year==n.getFullYear()&&this.month<n.getMonth()||this.year==n.getFullYear()&&this.month==n.getMonth()+1&&this.day<n.getDate()},n.prototype.goToCurrentDay=function(){var n=this,l=new Date,e=this.day,t=this.month,a=this.year;this.day=l.getDate(),this.month=l.getMonth()+1,this.year=l.getFullYear(),this.calculateCurrentMoment(),this.loaded=!1,this.fetchEvents().then(function(){n.isCurrentDay=!0}).catch(function(l){n.domUtils.showErrorModalDefault(l,"addon.calendar.errorloadevents",!0),n.year=a,n.month=t,n.day=e,n.calculateCurrentMoment()}).finally(function(){n.loaded=!0})},n.prototype.loadNext=function(){var n=this;this.increaseDay(),this.loaded=!1,this.fetchEvents().catch(function(l){n.domUtils.showErrorModalDefault(l,"addon.calendar.errorloadevents",!0),n.decreaseDay()}).finally(function(){n.loaded=!0})},n.prototype.loadPrevious=function(){var n=this;this.decreaseDay(),this.loaded=!1,this.fetchEvents().catch(function(l){n.domUtils.showErrorModalDefault(l,"addon.calendar.errorloadevents",!0),n.increaseDay()}).finally(function(){n.loaded=!0})},n.prototype.decreaseDay=function(){this.currentMoment.subtract(1,"day"),this.year=this.currentMoment.year(),this.month=this.currentMoment.month()+1,this.day=this.currentMoment.date()},n.prototype.increaseDay=function(){this.currentMoment.add(1,"day"),this.year=this.currentMoment.year(),this.month=this.currentMoment.month()+1,this.day=this.currentMoment.date()},n.prototype.markAsDeleted=function(n,l){var e=this.onlineEvents.find(function(l){return l.id==n});return!!e&&(e.deleted=l,!0)},n.prototype.isEventPast=function(n){return n.timestart+n.timeduration<this.currentTime},n.prototype.ngOnDestroy=function(){this.newEventObserver&&this.newEventObserver.off(),this.discardedObserver&&this.discardedObserver.off(),this.editEventObserver&&this.editEventObserver.off(),this.deleteEventObserver&&this.deleteEventObserver.off(),this.undeleteEventObserver&&this.undeleteEventObserver.off(),this.syncObserver&&this.syncObserver.off(),this.manualSyncObserver&&this.manualSyncObserver.off(),this.onlineObserver&&this.onlineObserver.unsubscribe(),this.filterChangedObserver&&this.filterChangedObserver.off(),this.obsDefaultTimeChange&&this.obsDefaultTimeChange.off()},n}(),W=function(){return function(){}}(),$=e(1524),H=e(1525),V=e(1526),Y=e(1527),R=e(1528),j=e(1529),B=e(1530),G=e(1531),z=e(1532),J=e(1533),q=e(1534),Q=e(1535),X=e(1536),Z=e(48),nn=e(9),ln=e(95),en=e(85),tn=e(80),an=e(26),un=e(18),rn=e(122),on=e(46),sn=e(42),cn=e(92),dn=e(128),fn=e(117),hn=e(91),_n=e(84),vn=e(252),mn=e(31),pn=e(8),yn=e(21),En=e(20),gn=e(27),bn=e(34),In=e(49),Dn=e(12),On=e(17),Tn=e(3),Cn=e(23),xn=e(7),wn=e(19),Pn=e(16),kn=e(22),Mn=e(30),Nn=e(28),An=e(44),Kn=e(43),Sn=e(32),Fn=e(37),Ln=e(90),Un=e(45),Wn=e(35),$n=e(284),Hn=e(259),Vn=e(219),Yn=e(285),Rn=e(193),jn=e(375),Bn=e(40),Gn=e(725),zn=e(214),Jn=e(36),qn=e(478),Qn=e(726),Xn=e(316),Zn=e(251),nl=e(376),ll=e(94),el=e(72),tl=e(78),al=e(186),il=e(110),ul=e(162),rl=e(215),ol=e(176),sl=e(167),cl=e(121),dl=e(55),fl=e(52),hl=e(71),_l=y._14({encapsulation:2,styles:[],data:{}}),vl=y._12("page-addon-calendar-day",U,function(n){return y._42(0,[(n()(),y._16(0,0,null,null,1,"page-addon-calendar-day",[],null,null,null,p,_l)),y._15(1,245760,null,0,U,[T.a,hl.a,F.a,y.D,C.a,kn.a,x.a,w.a,P.a,k.a,M.a,N.a,O.a,A.a,K.a,D.a,el.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),ml=e(24),pl=e(371),yl=e(372),El=e(374),gl=e(373),bl=e(477),Il=e(724),Dl=e(274);e.d(l,"AddonCalendarDayPageModuleNgFactory",function(){return Ol});var Ol=y._13(W,[],function(n){return y._25([y._26(512,y.n,y._6,[[8,[$.a,H.a,V.a,Y.a,R.a,j.a,B.a,G.a,z.a,J.a,q.a,Q.a,X.a,vl]],[3,y.n],y.B]),y._26(4608,pn.m,pn.l,[y.x,[2,pn.w]]),y._26(4608,ml.x,ml.x,[]),y._26(4608,ml.d,ml.d,[]),y._26(4608,pl.b,pl.a,[]),y._26(4608,yl.a,yl.b,[]),y._26(4608,El.b,El.a,[]),y._26(4608,gl.b,gl.a,[]),y._26(4608,un.a,un.a,[bl.a,pl.b,yl.a,El.b,gl.b,un.b,un.c]),y._26(512,pn.b,pn.b,[]),y._26(512,ml.v,ml.v,[]),y._26(512,ml.i,ml.i,[]),y._26(512,ml.s,ml.s,[]),y._26(512,Il.a,Il.a,[]),y._26(512,E.a,E.a,[]),y._26(512,b.a,b.a,[]),y._26(512,I.a,I.a,[]),y._26(512,g.a,g.a,[]),y._26(512,Il.b,Il.b,[]),y._26(512,W,W,[]),y._26(256,un.c,void 0,[]),y._26(256,un.b,void 0,[]),y._26(256,Dl.a,U,[])])})}});