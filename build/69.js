webpackJsonp([69],{2152:function(n,l,e){"use strict";function t(n){return h._42(0,[(n()(),h._16(0,0,null,null,6,"button",[["clear",""],["icon-only",""],["ion-button",""],["item-end",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.toggleDelete(e)&&t}return t},B.b,B.a)),h._15(1,1097728,[[2,4]],0,G.a,[[8,""],H.a,h.p,h.K],{clear:[0,"clear"]},null),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n                "])),(n()(),h._16(4,0,null,0,1,"ion-icon",[["ios","md-create"],["name","create"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(5,147456,null,0,q.a,[H.a,h.p,h.K],{name:[0,"name"],ios:[1,"ios"]},null),(n()(),h._40(-1,0,["\n            "]))],function(n,l){n(l,1,0,"");n(l,5,0,"create","md-create")},function(n,l){n(l,0,0,h._41(l,0,0,h._29(l,2).transform("core.delete")));n(l,4,0,h._29(l,5)._hidden)})}function o(n){return h._42(0,[(n()(),h._16(0,0,null,null,2,"core-empty-box",[["icon","chatbubbles"]],null,null,null,Q.b,Q.a)),h._15(1,49152,null,0,Z.a,[],{message:[0,"message"],icon:[1,"icon"]},null),h._32(131072,J.a,[Y.a,h.i])],function(n,l){n(l,1,0,h._41(l,1,0,h._29(l,2).transform("core.comments.nocomments")),"chatbubbles")},null)}function a(n){return h._42(0,[(n()(),h._16(0,0,null,null,8,"div",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),(n()(),h._40(-1,null,["\n            "])),(n()(),h._16(2,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(3,147456,null,0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(4,null,["\n            ","\n        "])),h._32(131072,J.a,[Y.a,h.i]),h._34(6,1),h._33(7,{$a:0}),h._32(131072,J.a,[Y.a,h.i])],function(n,l){n(l,3,0,"warning")},function(n,l){n(l,2,0,h._29(l,3)._hidden);n(l,4,0,h._41(l,4,0,h._29(l,8).transform("core.thereisdatatosync",n(l,7,0,h._41(l,4,0,n(l,6,0,h._29(l.parent,0),h._41(l,4,0,h._29(l,5).transform("core.comments.comments"))))))))})}function i(n){return h._42(0,[(n()(),h._16(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[24,"@coreSlideInOut",0],[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.deleteComment(e,o.offlineComment)&&t}return t},B.b,B.a)),h._15(1,1097728,[[4,4]],0,G.a,[[8,""],H.a,h.p,h.K],{color:[0,"color"],clear:[1,"clear"]},null),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n                    "])),(n()(),h._16(4,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(5,147456,null,0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(-1,0,["\n                "]))],function(n,l){n(l,1,0,"danger","");n(l,5,0,"trash")},function(n,l){n(l,0,0,"fromRight",h._41(l,0,1,h._29(l,2).transform("core.delete")));n(l,4,0,h._29(l,5)._hidden)})}function u(n){return h._42(0,[(n()(),h._16(0,0,null,null,38,"ion-card",[],null,[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.addComment(e)&&t}return t},null,null)),h._15(1,16384,null,0,nn.a,[H.a,h.p,h.K],null,null),(n()(),h._40(-1,null,["\n            "])),(n()(),h._16(3,0,null,null,23,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,ln.b,ln.a)),h._15(4,1097728,null,3,en.a,[tn.a,H.a,h.p,h.K,[2,on.a]],null,null),h._37(335544320,3,{contentLabel:0}),h._37(603979776,4,{_buttons:1}),h._37(603979776,5,{_icons:1}),h._15(8,16384,null,0,an.a,[],null,null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(10,0,null,0,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,un.b,un.a)),h._15(11,770048,null,0,rn.a,[sn.a,g.a,cn.a,mn.a,I.a,[2,fn.a]],{user:[0,"user"]},null),h._15(12,16384,null,0,_n.a,[],null,null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(14,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),h._40(15,null,["",""])),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(17,0,null,2,5,"p",[],null,null,null,null,null)),(n()(),h._40(-1,null,["\n                    "])),(n()(),h._16(19,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(20,147456,[[5,4]],0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(21,null,[" ","\n                "])),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,2,["\n                "])),(n()(),h._11(16777216,null,4,1,null,i)),h._15(25,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,2,["\n            "])),(n()(),h._40(-1,null,["\n            "])),(n()(),h._16(28,0,null,null,9,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,ln.b,ln.a)),h._15(29,1097728,null,3,en.a,[tn.a,H.a,h.p,h.K,[2,on.a]],null,null),h._37(335544320,6,{contentLabel:0}),h._37(603979776,7,{_buttons:1}),h._37(603979776,8,{_icons:1}),h._15(33,16384,null,0,an.a,[],null,null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(35,16777216,null,2,1,"core-format-text",[["clean","true"]],null,null,null,null,null)),h._15(36,540672,null,0,hn.a,[h.p,g.a,y.a,v.a,Y.a,pn.a,cn.a,gn.a,yn.a,vn.a,mn.a,bn.a,[2,sn.a],[2,In.a],[2,fn.a],Cn.a,I.a,xn.a,Dn.a,Ln.a,h.W],{text:[0,"text"],clean:[1,"clean"],contextLevel:[2,"contextLevel"],contextInstanceId:[3,"contextInstanceId"],courseId:[4,"courseId"]},null),(n()(),h._40(-1,2,["\n            "])),(n()(),h._40(-1,null,["\n        "]))],function(n,l){var e=l.component;n(l,11,0,e.offlineComment);n(l,20,0,"time");n(l,25,0,e.showDelete);n(l,36,0,e.offlineComment.content,"true",e.contextLevel,e.instanceId,e.courseId)},function(n,l){n(l,15,0,l.component.offlineComment.fullname);n(l,19,0,h._29(l,20)._hidden);n(l,21,0,h._41(l,21,0,h._29(l,22).transform("core.notsent")))})}function r(n){return h._42(0,[(n()(),h._16(0,0,null,null,2,"p",[],null,null,null,null,null)),(n()(),h._40(1,null,["",""])),h._34(2,2)],null,function(n,l){n(l,1,0,h._41(l,1,0,n(l,2,0,h._29(l.parent.parent,1),1e3*l.parent.context.$implicit.timecreated,"strftimerecentfull")))})}function s(n){return h._42(0,[(n()(),h._16(0,0,null,null,8,"p",[],null,null,null,null,null)),(n()(),h._40(-1,null,["\n                    "])),(n()(),h._16(2,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(3,147456,[[11,4]],0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(-1,null,[" "])),(n()(),h._16(5,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),h._40(6,null,["",""])),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,null,["\n                "]))],function(n,l){n(l,3,0,"trash")},function(n,l){n(l,2,0,h._29(l,3)._hidden);n(l,6,0,h._41(l,6,0,h._29(l,7).transform("core.deletedoffline")))})}function c(n){return h._42(0,[(n()(),h._16(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[24,"@coreSlideInOut",0],[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.deleteComment(e,n.parent.context.$implicit)&&t}return t},B.b,B.a)),h._15(1,1097728,[[10,4]],0,G.a,[[8,""],H.a,h.p,h.K],{color:[0,"color"],clear:[1,"clear"]},null),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n                    "])),(n()(),h._16(4,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(5,147456,null,0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(-1,0,["\n                "]))],function(n,l){n(l,1,0,"danger","");n(l,5,0,"trash")},function(n,l){n(l,0,0,"fromRight",h._41(l,0,1,h._29(l,2).transform("core.delete")));n(l,4,0,h._29(l,5)._hidden)})}function m(n){return h._42(0,[(n()(),h._16(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.undoDeleteComment(e,n.parent.context.$implicit)&&t}return t},B.b,B.a)),h._15(1,1097728,[[10,4]],0,G.a,[[8,""],H.a,h.p,h.K],{color:[0,"color"],clear:[1,"clear"]},null),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n                    "])),(n()(),h._16(4,0,null,0,1,"ion-icon",[["name","undo"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(5,147456,null,0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(-1,0,["\n                "]))],function(n,l){n(l,1,0,"danger","");n(l,5,0,"undo")},function(n,l){n(l,0,0,h._41(l,0,0,h._29(l,2).transform("core.restore")));n(l,4,0,h._29(l,5)._hidden)})}function f(n){return h._42(0,[(n()(),h._16(0,0,null,null,40,"ion-card",[],null,null,null,null,null)),h._15(1,16384,null,0,nn.a,[H.a,h.p,h.K],null,null),(n()(),h._40(-1,null,["\n            "])),(n()(),h._16(3,0,null,null,25,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,ln.b,ln.a)),h._15(4,1097728,null,3,en.a,[tn.a,H.a,h.p,h.K,[2,on.a]],null,null),h._37(335544320,9,{contentLabel:0}),h._37(603979776,10,{_buttons:1}),h._37(603979776,11,{_icons:1}),h._15(8,16384,null,0,an.a,[],null,null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(10,0,null,0,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,un.b,un.a)),h._15(11,770048,null,0,rn.a,[sn.a,g.a,cn.a,mn.a,I.a,[2,fn.a]],{user:[0,"user"]},null),h._15(12,16384,null,0,_n.a,[],null,null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(14,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),h._40(15,null,["",""])),(n()(),h._40(-1,2,["\n                "])),(n()(),h._11(16777216,null,2,1,null,r)),h._15(18,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._11(16777216,null,2,1,null,s)),h._15(21,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._11(16777216,null,4,1,null,c)),h._15(24,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._11(16777216,null,4,1,null,m)),h._15(27,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,2,["\n            "])),(n()(),h._40(-1,null,["\n            "])),(n()(),h._16(30,0,null,null,9,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,ln.b,ln.a)),h._15(31,1097728,null,3,en.a,[tn.a,H.a,h.p,h.K,[2,on.a]],null,null),h._37(335544320,12,{contentLabel:0}),h._37(603979776,13,{_buttons:1}),h._37(603979776,14,{_icons:1}),h._15(35,16384,null,0,an.a,[],null,null),(n()(),h._40(-1,2,["\n                "])),(n()(),h._16(37,16777216,null,2,1,"core-format-text",[],null,null,null,null,null)),h._15(38,540672,null,0,hn.a,[h.p,g.a,y.a,v.a,Y.a,pn.a,cn.a,gn.a,yn.a,vn.a,mn.a,bn.a,[2,sn.a],[2,In.a],[2,fn.a],Cn.a,I.a,xn.a,Dn.a,Ln.a,h.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),h._40(-1,2,["\n            "])),(n()(),h._40(-1,null,["\n        "]))],function(n,l){var e=l.component;n(l,11,0,l.context.$implicit);n(l,18,0,!l.context.$implicit.deleted);n(l,21,0,l.context.$implicit.deleted);n(l,24,0,e.showDelete&&!l.context.$implicit.deleted&&l.context.$implicit.delete);n(l,27,0,e.showDelete&&l.context.$implicit.deleted);n(l,38,0,l.context.$implicit.content,e.contextLevel,e.instanceId,e.courseId)},function(n,l){n(l,15,0,l.context.$implicit.fullname)})}function _(n){return h._42(0,[(n()(),h._16(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,wn.b,wn.a)),h._15(1,212992,null,0,kn.a,[h.p,In.a],null,null),h._15(2,1228800,null,2,Pn.a,[pn.a],null,null),h._37(335544320,15,{_mainButton:0}),h._37(603979776,16,{_fabLists:1}),(n()(),h._40(-1,0,["\n        "])),(n()(),h._16(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.addComment(e)&&t}return t},On.b,On.a)),h._15(7,49152,[[15,4]],0,Un.a,[H.a,h.p,h.K],null,null),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n            "])),(n()(),h._16(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._15(11,147456,null,0,q.a,[H.a,h.p,h.K],{name:[0,"name"]},null),(n()(),h._40(-1,0,["\n        "])),(n()(),h._40(-1,0,["\n    "]))],function(n,l){n(l,1,0);n(l,11,0,"add")},function(n,l){n(l,6,0,h._41(l,6,0,h._29(l,8).transform("core.comments.addcomment")));n(l,10,0,h._29(l,11)._hidden)})}function d(n){return h._42(0,[h._32(0,dn.h,[]),h._32(0,Nn.a,[yn.a,b.a]),h._37(402653184,1,{content:0}),(n()(),h._16(3,0,null,null,32,"ion-header",[],null,null,null,null,null)),h._15(4,16384,null,0,Kn.a,[H.a,h.p,h.K,[2,Tn.a]],null,null),(n()(),h._40(-1,null,["\n    "])),(n()(),h._16(6,0,null,null,28,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Mn.b,Mn.a)),h._15(7,49152,null,0,An.a,[En.a,[2,Tn.a],[2,sn.a],H.a,h.p,h.K],null,null),h._15(8,212992,null,0,Wn.a,[An.a,pn.a,Y.a,I.a],null,null),(n()(),h._40(-1,3,["\n        "])),(n()(),h._16(10,0,null,3,3,"ion-title",[],null,null,null,Sn.b,Sn.a)),h._15(11,49152,null,0,Xn.a,[H.a,h.p,h.K,[2,$n.a],[2,An.a]],null,null),(n()(),h._16(12,16777216,null,0,1,"core-format-text",[],null,null,null,null,null)),h._15(13,540672,null,0,hn.a,[h.p,g.a,y.a,v.a,Y.a,pn.a,cn.a,gn.a,yn.a,vn.a,mn.a,bn.a,[2,sn.a],[2,In.a],[2,fn.a],Cn.a,I.a,xn.a,Dn.a,Ln.a,h.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),h._40(-1,3,["\n        "])),(n()(),h._16(15,0,null,2,18,"ion-buttons",[["end",""]],null,null,null,null,null)),h._15(16,16384,null,1,Rn.a,[H.a,h.p,h.K,[2,$n.a],[2,An.a]],null,null),h._37(603979776,2,{_buttons:1}),(n()(),h._40(-1,null,["\n            "])),(n()(),h._11(16777216,null,null,1,null,t)),h._15(20,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,null,["\n            "])),(n()(),h._16(22,0,null,null,10,"core-context-menu",[],null,null,null,Vn.b,Vn.a)),h._15(23,245760,null,0,jn.a,[Y.a,Fn.a,h.p,y.a,[2,zn.a],cn.a],null,null),(n()(),h._40(-1,0,["\n                "])),(n()(),h._16(25,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.refreshComments(!1)&&t}return t},Bn.b,Bn.a)),h._15(26,770048,null,0,Gn.a,[jn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n                "])),(n()(),h._16(29,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.refreshComments(!0)&&t}return t},Bn.b,Bn.a)),h._15(30,770048,null,0,Gn.a,[jn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,0,["\n            "])),(n()(),h._40(-1,null,["\n        "])),(n()(),h._40(-1,3,["\n    "])),(n()(),h._40(-1,null,["\n"])),(n()(),h._40(-1,null,["\n"])),(n()(),h._16(37,0,null,null,32,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,Hn.b,Hn.a)),h._15(38,4374528,[[1,4]],0,In.a,[H.a,pn.a,Jn.a,h.p,h.K,En.a,Yn.a,h.D,[2,Tn.a],[2,sn.a]],null,null),(n()(),h._40(-1,1,["\n    "])),(n()(),h._16(40,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,l,e){var t=!0;if("ionRefresh"===l){t=!1!==n.component.refreshComments(!1,e)&&t}return t},null,null)),h._15(41,212992,null,0,qn.a,[pn.a,In.a,h.D,Qn.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),h._40(-1,null,["\n        "])),(n()(),h._16(43,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,Zn.b,Zn.a)),h._15(44,114688,null,0,nl.a,[qn.a,H.a],{pullingText:[0,"pullingText"]},null),h._32(131072,J.a,[Y.a,h.i]),(n()(),h._40(-1,null,["\n    "])),(n()(),h._40(-1,1,["\n    "])),(n()(),h._16(48,0,null,1,17,"core-loading",[],null,null,null,ll.b,ll.a)),h._15(49,638976,null,0,el.a,[Y.a,h.p,I.a,cn.a],{hideUntil:[0,"hideUntil"]},null),(n()(),h._40(-1,0,["\n        "])),(n()(),h._11(16777216,null,0,1,null,o)),h._15(52,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,0,["\n\n        "])),(n()(),h._11(16777216,null,0,1,null,a)),h._15(55,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,0,["\n\n        "])),(n()(),h._11(16777216,null,0,1,null,u)),h._15(58,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,0,["\n\n        "])),(n()(),h._11(16777216,null,0,1,null,f)),h._15(61,802816,null,0,dn.j,[h.W,h.T,h.v],{ngForOf:[0,"ngForOf"]},null),(n()(),h._40(-1,0,["\n\n        "])),(n()(),h._16(63,0,null,0,1,"core-infinite-loading",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.loadMore(e)&&t}return t},tl.b,tl.a)),h._15(64,573440,null,0,ol.a,[[2,In.a],y.a],{enabled:[0,"enabled"],error:[1,"error"]},{action:"action"}),(n()(),h._40(-1,0,["\n    "])),(n()(),h._40(-1,1,["\n\n    "])),(n()(),h._11(16777216,null,0,1,null,_)),h._15(68,16384,null,0,dn.k,[h.W,h.T],{ngIf:[0,"ngIf"]},null),(n()(),h._40(-1,1,["\n"])),(n()(),h._40(-1,null,["\n"]))],function(n,l){var e=l.component;n(l,8,0);n(l,13,0,e.title,e.contextLevel,e.instanceId,e.courseId);n(l,20,0,e.canDeleteComments),n(l,23,0);n(l,26,0,h._41(l,26,0,h._29(l,27).transform("core.refresh")),e.refreshIcon,!0,100,!(e.commentsLoaded&&!e.hasOffline));n(l,30,0,h._41(l,30,0,h._29(l,31).transform("core.settings.synchronizenow")),e.syncIcon,!1,100,!(e.commentsLoaded&&e.hasOffline));n(l,41,0,e.commentsLoaded);n(l,44,0,h._19(1,"",h._41(l,44,0,h._29(l,45).transform("core.pulltorefresh")),""));n(l,49,0,e.commentsLoaded);n(l,52,0,!e.comments||!e.comments.length);n(l,55,0,e.hasOffline);n(l,58,0,e.offlineComment);n(l,61,0,e.comments);n(l,64,0,e.canLoadMore,e.loadMoreError);n(l,68,0,e.canAddComments)},function(n,l){n(l,6,0,h._29(l,7)._hidden,h._29(l,7)._sbPadding);n(l,37,0,h._29(l,38).statusbarPadding,h._29(l,38)._hasRefresher);n(l,40,0,"inactive"!==h._29(l,41).state,h._29(l,41)._top);n(l,43,0,h._29(l,44).r.state)})}Object.defineProperty(l,"__esModule",{value:!0});var h=e(1),p=(e(0),e(6),e(4)),g=(e(747),e(2)),y=e(5),v=e(12),b=e(25),I=e(11),C=e(47),x=e(156),D=e(392),L=e(525),w=function(){function n(n,l,e,t,o,a,i,u,r,s,c,m){var f=this;this.sitesProvider=l,this.userProvider=e,this.domUtils=t,this.translate=o,this.modalCtrl=a,this.commentsProvider=i,this.offlineComments=u,this.eventsProvider=r,this.commentsSync=s,this.textUtils=c,this.timeUtils=m,this.comments=[],this.commentsLoaded=!1,this.canLoadMore=!1,this.loadMoreError=!1,this.canAddComments=!1,this.canDeleteComments=!1,this.showDelete=!1,this.hasOffline=!1,this.refreshIcon="spinner",this.syncIcon="spinner",this.addDeleteCommentsAvailable=!1,this.contextLevel=n.get("contextLevel"),this.instanceId=n.get("instanceId"),this.componentName=n.get("componentName"),this.itemId=n.get("itemId"),this.area=n.get("area")||"",this.title=n.get("title")||this.translate.instant("core.comments.comments"),this.courseId=n.get("courseId"),this.page=0,this.syncObserver=r.on(L.a.AUTO_SYNCED,function(n){n.contextLevel==f.contextLevel&&n.instanceId==f.instanceId&&n.componentName==f.componentName&&n.itemId==f.itemId&&n.area==f.area&&(f.showSyncWarnings(n.warnings),f.commentsLoaded=!1,f.refreshIcon="spinner",f.syncIcon="spinner",f.domUtils.scrollToTop(f.content),f.page=0,f.comments=[],f.fetchComments(!1))},l.getCurrentSiteId())}return n.prototype.ionViewDidLoad=function(){var n=this;this.commentsProvider.isAddCommentsAvailable().then(function(l){n.addDeleteCommentsAvailable=l}),this.currentUserId=this.sitesProvider.getCurrentSiteUserId(),this.fetchComments(!0)},n.prototype.fetchComments=function(n,l){var e=this;this.loadMoreError=!1;return(n?this.syncComments(l):Promise.resolve()).catch(function(){}).then(function(){return e.commentsProvider.getComments(e.contextLevel,e.instanceId,e.componentName,e.itemId,e.area,e.page).then(function(n){e.canAddComments=e.addDeleteCommentsAvailable&&n.canpost;var l=n.comments.sort(function(n,l){return l.timecreated-n.timecreated});return e.canLoadMore=void 0!==n.count?e.comments.length+l.length>n.count:n.comments.length>0&&n.comments.length>=x.a.pageSize,Promise.all(l.map(function(n){return e.loadCommentProfile(n)}))}).then(function(n){e.comments=e.comments.concat(n),e.canDeleteComments=e.addDeleteCommentsAvailable&&(e.hasOffline||e.comments.some(function(n){return!!n.delete}))})}).then(function(){return e.loadOfflineData()}).catch(function(n){e.loadMoreError=!0,n&&"assignsubmission_comments"==e.componentName?e.domUtils.showAlertTranslated("core.notice","core.comments.commentsnotworking"):e.domUtils.showErrorModalDefault(n,e.translate.instant("core.error")+": get_comments")}).finally(function(){e.commentsLoaded=!0,e.refreshIcon="refresh",e.syncIcon="sync"})},n.prototype.loadMore=function(n){return this.page++,this.canLoadMore=!1,this.fetchComments(!0).finally(function(){n&&n()})},n.prototype.refreshComments=function(n,l){var e=this;return this.commentsLoaded=!1,this.refreshIcon="spinner",this.syncIcon="spinner",this.invalidateComments().finally(function(){return e.page=0,e.comments=[],e.fetchComments(!0,n).finally(function(){l&&l.complete()})})},n.prototype.showSyncWarnings=function(n){var l=this.textUtils.buildMessage(n);l&&this.domUtils.showErrorModal(l)},n.prototype.syncComments=function(n){var l=this;return this.commentsSync.syncComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(n){l.showSyncWarnings(n)}).catch(function(e){return n&&l.domUtils.showErrorModalDefault(e,"core.errorsync",!0),Promise.reject(null)})},n.prototype.addComment=function(n){var l=this;n.preventDefault(),n.stopPropagation();var e=this.modalCtrl.create("CoreCommentsAddPage",{contextLevel:this.contextLevel,instanceId:this.instanceId,componentName:this.componentName,itemId:this.itemId,area:this.area,content:this.hasOffline?this.offlineComment.content:""});e.onDidDismiss(function(n){return n&&n.comments?(l.invalidateComments(),Promise.all(n.comments.map(function(n){return l.loadCommentProfile(n)})).then(function(n){l.comments=n.concat(l.comments),l.canDeleteComments=l.addDeleteCommentsAvailable,l.eventsProvider.trigger(x.a.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:l.contextLevel,instanceId:l.instanceId,component:l.componentName,itemId:l.itemId,area:l.area,countChange:n.length},l.sitesProvider.getCurrentSiteId())})):n&&!n.comments?l.loadOfflineData():void 0}),e.present()},n.prototype.deleteComment=function(n,l){var e=this;n.preventDefault(),n.stopPropagation();var t=this.timeUtils.userDate(1e3*(l.lastmodified||l.timecreated),"core.strftimerecentfull");l.contextlevel=this.contextLevel,l.instanceid=this.instanceId,l.component=this.componentName,l.itemid=this.itemId,l.area=this.area,this.domUtils.showDeleteConfirm("core.comments.deletecommentbyon",{$a:{user:l.fullname||"",time:t}}).then(function(){e.commentsProvider.deleteComment(l).then(function(n){if(e.showDelete=!1,n){var t=e.comments.findIndex(function(n){return n.id==l.id});t>=0&&(e.comments.splice(t,1),e.eventsProvider.trigger(x.a.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:e.contextLevel,instanceId:e.instanceId,component:e.componentName,itemId:e.itemId,area:e.area,countChange:-1},e.sitesProvider.getCurrentSiteId()))}else e.loadOfflineData();e.invalidateComments(),e.domUtils.showToast("core.comments.eventcommentdeleted",!0,3e3)}).catch(function(n){e.domUtils.showErrorModalDefault(n,"Delete comment failed.")})}).catch(function(){})},n.prototype.invalidateComments=function(){return this.commentsProvider.invalidateCommentsData(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area)},n.prototype.loadCommentProfile=function(n){return this.userProvider.getProfile(n.userid,void 0,!0).then(function(l){return n.profileimageurl=l.profileimageurl,n.fullname=l.fullname,n.userid=l.id,n}).catch(function(){return n})},n.prototype.loadOfflineData=function(){var n=this,l=[],e=!1;return l.push(this.offlineComments.getComment(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(l){l&&!n.currentUser?(l.userid=n.currentUserId,n.loadCommentProfile(l).then(function(l){l.fullname&&(n.currentUser={},n.currentUser.profileimageurl=l.profileimageurl,n.currentUser.fullname=l.fullname,n.currentUser.userid=l.userid)})):l&&(l.profileimageurl=n.currentUser.profileimageurl,l.fullname=n.currentUser.fullname,l.userid=n.currentUser.id),n.offlineComment=l})),l.push(this.offlineComments.getDeletedComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(l){(e=l&&l.length>0)&&l.forEach(function(l){var e=n.comments.find(function(n){return n.id==l.commentid});e&&(e.deleted=l.deleted)})})),Promise.all(l).then(function(){n.hasOffline=!!n.offlineComment||e})},n.prototype.undoDeleteComment=function(n,l){var e=this;n.preventDefault(),n.stopPropagation(),this.offlineComments.undoDeleteComment(l.id).then(function(){l.deleted=!1,e.showDelete=!1})},n.prototype.toggleDelete=function(){this.showDelete=!this.showDelete},n.prototype.ngOnDestroy=function(){this.syncObserver&&this.syncObserver.off()},n}(),k=e(29),P=e(33),O=e(109),U=e(378),N=function(){return function(){}}(),K=e(1524),T=e(1525),M=e(1526),A=e(1527),E=e(1528),W=e(1529),S=e(1530),X=e(1531),$=e(1532),R=e(1533),V=e(1534),j=e(1535),F=e(1536),z=e(484),B=e(46),G=e(42),H=e(9),J=e(26),Y=e(18),q=e(48),Q=e(128),Z=e(117),nn=e(92),ln=e(31),en=e(21),tn=e(20),on=e(27),an=e(34),un=e(216),rn=e(187),sn=e(22),cn=e(3),mn=e(10),fn=e(28),_n=e(163),dn=e(8),hn=e(49),pn=e(17),gn=e(23),yn=e(7),vn=e(19),bn=e(16),In=e(30),Cn=e(44),xn=e(43),Dn=e(32),Ln=e(37),wn=e(284),kn=e(259),Pn=e(219),On=e(285),Un=e(193),Nn=e(230),Kn=e(375),Tn=e(40),Mn=e(725),An=e(214),En=e(36),Wn=e(478),Sn=e(726),Xn=e(316),$n=e(251),Rn=e(376),Vn=e(94),jn=e(80),Fn=e(72),zn=e(78),Bn=e(95),Gn=e(85),Hn=e(186),Jn=e(35),Yn=e(110),qn=e(162),Qn=e(45),Zn=e(215),nl=e(176),ll=e(55),el=e(52),tl=e(377),ol=e(276),al=e(71),il=e(165),ul=h._14({encapsulation:2,styles:[],data:{animation:[{type:7,name:"coreSlideInOut",definitions:[{type:1,expr:"void => fromLeft",animation:[{type:6,styles:{transform:"translateX(0)",opacity:1},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:0,transform:"translateX(-100%)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(5%)",offset:.7},offset:null},{type:6,styles:{opacity:1,transform:"translateX(0)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"fromLeft => void",animation:[{type:6,styles:{transform:"translateX(-100%)",opacity:0},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:1,transform:"translateX(0)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(5%)",offset:.3},offset:null},{type:6,styles:{opacity:0,transform:"translateX(-100%)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"void => fromRight",animation:[{type:6,styles:{transform:"translateX(0)",opacity:1},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:0,transform:"translateX(100%)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(-5%)",offset:.7},offset:null},{type:6,styles:{opacity:1,transform:"translateX(0)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"fromRight => void",animation:[{type:6,styles:{transform:"translateX(-100%)",opacity:0},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:1,transform:"translateX(0)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(-5%)",offset:.3},offset:null},{type:6,styles:{opacity:0,transform:"translateX(100%)",offset:1},offset:null}]},timings:300}],options:null}],options:{}}]}}),rl=h._12("page-core-comments-viewer",w,function(n){return h._42(0,[(n()(),h._16(0,0,null,null,1,"page-core-comments-viewer",[],null,null,null,d,ul)),h._15(1,180224,null,0,w,[al.a,g.a,C.a,y.a,Y.a,il.a,x.a,D.a,I.a,L.a,v.a,b.a],null,null)],null,null)},{},{},[]),sl=e(24),cl=e(371),ml=e(372),fl=e(374),_l=e(373),dl=e(477),hl=e(724),pl=e(274);e.d(l,"CoreCommentsViewerPageModuleNgFactory",function(){return gl});var gl=h._13(N,[],function(n){return h._25([h._26(512,h.n,h._6,[[8,[K.a,T.a,M.a,A.a,E.a,W.a,S.a,X.a,$.a,R.a,V.a,j.a,F.a,z.a,rl]],[3,h.n],h.B]),h._26(4608,dn.m,dn.l,[h.x,[2,dn.w]]),h._26(4608,sl.x,sl.x,[]),h._26(4608,sl.d,sl.d,[]),h._26(4608,cl.b,cl.a,[]),h._26(4608,ml.a,ml.b,[]),h._26(4608,fl.b,fl.a,[]),h._26(4608,_l.b,_l.a,[]),h._26(4608,Y.a,Y.a,[dl.a,cl.b,ml.a,fl.b,_l.b,Y.b,Y.c]),h._26(512,dn.b,dn.b,[]),h._26(512,sl.v,sl.v,[]),h._26(512,sl.i,sl.i,[]),h._26(512,sl.s,sl.s,[]),h._26(512,hl.a,hl.a,[]),h._26(512,p.a,p.a,[]),h._26(512,P.a,P.a,[]),h._26(512,O.a,O.a,[]),h._26(512,k.a,k.a,[]),h._26(512,U.a,U.a,[]),h._26(512,hl.b,hl.b,[]),h._26(512,N,N,[]),h._26(256,Y.c,void 0,[]),h._26(256,Y.b,void 0,[]),h._26(256,pl.a,w,[])])})}});